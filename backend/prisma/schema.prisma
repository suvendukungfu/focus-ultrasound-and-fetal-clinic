generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  EDITOR
  VIEWER
}

enum LeadStatus {
  NEW
  CONTACTED
  CONVERTED
  CLOSED
}

enum AppointmentStatus {
  PENDING
  CONFIRMED
  COMPLETED
  CANCELLED
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String
  password  String
  role      Role     @default(VIEWER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  auditLogs AuditLog[]

  @@map("users")
}

model Lead {
  id        String     @id @default(uuid())
  name      String
  email     String?
  phone     String
  message   String?
  source    String     @default("website")
  status    LeadStatus @default(NEW)
  notes     String?
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt

  @@map("leads")
}

model Doctor {
  id             String        @id @default(uuid())
  name           String
  specialization String
  bio            String?
  imageUrl       String?
  isActive       Boolean       @default(true)
  appointments   Appointment[]
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt

  @@map("doctors")
}

model Service {
  id          String   @id @default(uuid())
  name        String
  description String?
  price       Decimal?
  durationMin Int      @default(30)
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  appointments Appointment[]

  @@map("services")
}

model Appointment {
  id        String            @id @default(uuid())
  date      DateTime
  status    AppointmentStatus @default(PENDING)
  notes     String?
  
  patientName  String
  patientPhone String
  patientEmail String?

  doctorId  String?
  doctor    Doctor?   @relation(fields: [doctorId], references: [id])

  serviceId String?
  service   Service?  @relation(fields: [serviceId], references: [id])

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("appointments")
}

model BlogPost {
  id              String   @id @default(uuid())
  title           String
  slug            String   @unique
  content         String   @db.Text
  excerpt         String?
  metaTitle       String?
  metaDescription String?
  keywords        String[]
  isPublished     Boolean  @default(false)
  publishedAt     DateTime?
  authorId        String?
  locale          String   @default("en") // 'en' or 'hi'

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  @@map("blog_posts")
}

model Review {
  id        String   @id @default(uuid())
  author    String
  rating    Int
  content   String?
  isApproved Boolean @default(false)
  createdAt DateTime @default(now())

  @@map("reviews")
}

model AuditLog {
  id        String   @id @default(uuid())
  userId    String?
  user      User?    @relation(fields: [userId], references: [id])
  action    String
  resource  String
  ip        String?
  metadata  Json?
  createdAt DateTime @default(now())

  @@map("audit_logs")
}
